{% extends "pages/base.html" %}
{% load static %}
{% block css %}
<link rel="stylesheet" href="{% static 'stlyes/result.css' %}">
{% endblock %}
{% block script %}
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>{% endblock %}
{% block content %}
<h2>ผลการวิเคราะห์</h2>
<!-- ปุ่มแสดงตารางและกราฟ -->
<!-- <div class="d-flex justify-content-center my-3">
    <button id="showTable" class="btn btn-primary mx-2">แสดงตาราง</button>
    <button id="showGraph" class="btn btn-secondary mx-2">แสดงกราฟ</button>
</div> -->

{% if results %}
<div id="table-container" class="mt-3">
    <table class="table table-bordered text-center">
        <thead class="table-dark">
            <tr>
                <th>ID</th>
                <th>วิชา</th>
                <th>จำนวนความคิดเห็น</th>
                <th>ข้อความเชิงบวก</th>
                <th>ข้อความเชิงลบ</th>
            </tr>
        </thead>
        <tbody>
            {% for k, v in results.items %}
            <tr>
                <td>{{ forloop.counter }}</td>
                <td>{{ k }}</td>
                <td>{{ v.count }}</td>
                <td>{{v.Positive}}</td>
                <td>{{v.Negative}}</td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
</div>
<div id="chart-container" class="mt-3">
    <canvas id="myChart" width="400" height="200"></canvas>
</div>
<script>

    /* // button show table and graph
    document.getElementById("showTable").addEventListener("click", function () {
        document.getElementById("table-container").style.display = "block";
        document.getElementById("chart-container").style.display = "none";
    });

    document.getElementById('showGraph').addEventListener("click", function () {
        document.getElementById("table-container").style.display = "none";
        document.getElementById("chart-container").style.display = "block";
    }) */
    /* fetch("{% url 'apidata' %}")
        .then(response => response.json())
        .then(data => {
            const ctx = document.getElementById('myChart').getContext('2d');
        // Fetch data from Django View
          new Chart(ctx, {
                type: 'bar', // Change to 'line', 'pie', etc., if needed
                data: data,
                options: {
                    responsive: true,
                    plugins: {
                        legend: { position: 'top' },
                        title: { display: true, text: 'Sales Data' }
                    }
                }
            });
        }); */
    /*// Download CSV
    document.getElementById("downloadCSV").addEventListener("click", function() {
        let csvContent = "data:text/csv;charset=utf-8,ID,วิชา,จำนวนความคิดเห็น,ข้อความเชิงบวก,ข้อความเชิงลบ\n";
        {% for k, v in results.items %}
            csvContent += "{{ forloop.counter }},{{ k }},{{ v.count }},{{ v.Positive }},{{ v.Negative }}\n";
        {% endfor %}
        let encodedUri = encodeURI(csvContent);
        let link = document.createElement("a");
        link.setAttribute("href", encodedUri);
        link.setAttribute("download", "data.csv");
        document.body.appendChild(link);
        link.click();
    }); */
    /* // Download Graph
    document.getElementById("downloadChart").addEventListener("click", function () {
        let a = document.createElement('a');
        a.href = document.getElementById('myChart').toDataURL('image/jpg');
        a.download = 'chart.jpg';
        document.body.appendChild(a);
        a.click();
    }); */
</script>
{% endif %}
{% endblock %}